---
permalink: /animationqr/
---
<!doctype html>
<html>

<script src = "https://aframe.io/releases/1.0.4/aframe.min.js"></script>
<script src = "https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

<script>
var garbageBin;
window.onload = function ()
{
if (typeof(garbageBin) === 'undefined')
    {
    //Here we are creating a 'garbage bin' object to temporarily 
    //store elements that are to be discarded
    garbageBin = document.createElement('div');
    garbageBin.style.display = 'none'; //Make sure it is not displayed
    document.body.appendChild(garbageBin);
    }
function discardElement(element)
    {
    //The way this works is due to the phenomenon whereby child nodes
    //of an object with it's innerHTML emptied are removed from memory

    //Move the element to the garbage bin element
    garbageBin.appendChild(element);
    //Empty the garbage bin
    garbageBin.innerHTML = "";
    }
}
</script>

<script> <!--Remove loading screen when page & camera loaded-->
        window.addEventListener('arjs-video-loaded', function () {
            console.log("arjs-video-loaded");
            
            //remove
            garbageBin.appendChild(splash);
            garbageBin.innerHTML = "";
        })
</script>

<script defer> <!--Detects when marker is found or lost. Currently plays/pauses video accordingly. markerhandler to be put in a-marker.-->
    var currentMarker = 'null';
    AFRAME.registerComponent("markerhandler", {
      init: function () {
          const marker = this.el;
          marker.addEventListener("markerFound", function () {
                
              // things to occur when marker is found
              var markerID = marker.id;
              console.log('Marker Detected: ', markerID);
              currentMarker = markerID;
              console.log('currentMarker: ', currentMarker);
              
              // if markerID is this... plays the video of the marker's (hiro marker currently not in use)
              if (markerID = "pattern-qr-code-animationqr") {
                  mantarayanimation.play();
              } else if (markerID = "hiro") {
                  zebrasharkanimation.play();
              }
              
              // enables and shows playpause button, removes the marker reference image on user's device, shows marker found text
              playpausebutton.disabled = false;
              playpausebutton.style.display = 'inline';
              markerimageref.style.display = 'none';
              sidetext.innerHTML = sidetext.innerHTML.replace('Find and scan me!','Marker found!');
              sidetext.style.color = '#017d05'
              
              //enables enter button
              enterbutton.style.display = 'inline';
              enterbutton.disabled = false;
              
          })
          marker.addEventListener("markerLost", function () {
              
              // things to occur when marker is lost
              var markerID = marker.id;
              console.log('Marker Lost: ', markerID);
              currentMarker = 'null';
              console.log('currentMarker: ', currentMarker);
              
              // if markerID is this... pauses the video of the marker's (hiro marker currently not in use)
              if (markerID = "pattern-qr-code-animationqr") {
                  mantarayanimation.pause();
              } else if (markerID = "hiro") {
                  zebrasharkanimation.pause();
              }
              
              // disables and hides playpause button, adds the marker reference image on user's device, shows marker not found text
              playpausebutton.disabled = true;
              playpausebutton.style.display = 'none';
              markerimageref.style.display = 'inline';
              sidetext.innerHTML = sidetext.innerHTML.replace('Marker found! üëç','Find and scan me!');
              sidetext.style.color = '#d90202'
              
              //disables enter button
              enterbutton.style.display = 'none';
              enterbutton.disabled = true;
              
          })
      }
  });
</script>

<script> <!--Changes button image when video playing/paused. Dynamic playpause button-->
    function videoplaying(videoID) {
        buttonimg.src = "../files/pause-256.png";
        console.log("playing video: ", videoID);
    }
    function videopaused(videoID) {
        buttonimg.src = "../files/play-256.png";
        console.log("paused video: ", videoID);
    }

    function playpause() {
        console.log("play pause: ", currentMarker);
        
        // if currentmarker is this... play its video (hiro marker currently not in use)
        if (currentMarker = "pattern-qr-code-animationqr") { 
              if (mantarayanimation.paused) {
                  mantarayanimation.play();
              } else {
                  mantarayanimation.pause();
              }
        } else if (currentMarker = "hiro") { 
              if (zebrasharkanimation.paused) {
                  zebrasharkanimation.play();
              } else {
                  zebrasharkanimation.pause();
              }
        }
    }
</script>

<script>
    // only runs when content loaded (not images or other media)
    document.addEventListener("DOMContentLoaded", function(){
    // why is there an fps counter???????? ü§îü§®üòüüòßüòßüò©üò©
    var fps = document.getElementById("fps");
    var startTime = Date.now();
    var frame = 0;
    
    function tick() {
        var time = Date.now();
        frame++;
        if (time - startTime > 1000) {
            fps.innerHTML = (frame / ((time - startTime) / 1000)).toFixed(1);
            startTime = time;
            frame = 0;
        }
        window.requestAnimationFrame(tick);
    }
    tick();
    }); 
</script> 

<script>
    function transition() {
        //enterbutton removal animation
        enterbutton.className = "fadedown";
        
        //throw away enterbutton once after delay (500ms animation finish)
        setTimeout(() => { garbageBin.appendChild(enterbutton);
                           garbageBin.innerHTML = ""; 
                         }, 500);
        
        //start cool wave animation
        
    }
</script>

<style>
    /* animation of enterbutton poppin in and out */
    .poppin {
       position:absolute;
       top:10%;
       left:10%;
       -webkit-animation-name:grow;
       -webkit-animation-duration:2s;
       -webkit-animation-iteration-count:infinite;
       -webkit-animation-timing-function:linear;
       -moz-animation-name:grow;
       -moz-animation-duration:2s;
       -moz-animation-iteration-count:infinite;
       -moz-animation-timing-function:linear;
       -ms-animation-name:grow;
       -ms-animation-duration:2s;
       -ms-animation-iteration-count:infinite;
       -ms-animation-timing-function:linear;
    }
    @-webkit-keyframes grow
     {
       0% {
          -webkit-transform:scale(1);
       }
       50% {
          -webkit-transform:scale(1.4);
       }
       100% {
          -webkit-transform:scale(1);
       }
    }  
    @-moz-keyframes grow
     {
       0% {
          -moz-transform:scale(1);
       }
       50% {
          -moz-transform:scale(1.4);
       }
       100% {
          -moz-transform:scale(1);
       }
    }
    @-ms-keyframes grow
     {
       0% {
          -ms-transform:scale(1);
       }
       50% {
          -ms-transform:scale(1.4);
       }
       100% {
          -ms-transform:scale(1);
       }
    }

    /* animation for after press animation button */
    .fadedown {
        animation: fadedown 0.5s forwards;
    }
    @keyframes fadedown {
        0% {
            transform: translateY(0px);
            opacity: 1;
        }
        100% {
            transform: translateY(100px);
            opacity: 0;
        }
    }
    
</style>
    
<body style = "overflow: hidden">
    <div 
        id = "splash"
        style = "position: fixed;
               z-index: 99999;
               display: flex;
               align-items: center;
               justify-content: center;
               flex-direction: column;
               top: 0;
               bottom: 0;
               left: 0;
               right: 0;
               margin: auto;
               background-color: #000000;"
               >
        <div id = "loading"
             style = "width: 24px;
                      height: 24px;
                      border-radius: 50%;
                      border: 0.25rem solid rgba(255, 255, 255, 0.2);
                      border-top-color: white;
                      animation: spin 1s infinite linear;">
            <style>
                @keyframes spin {
                    0% {
                        transform: rotate(0deg);
                    }
                100% {
                        transform: rotate(360deg);
                    }
                }
            </style>
        </div>
    </div>
    
    <a-scene 
        vr-mode-ui = "enabled: false;"
        loading-screen = "enabled: true;"
        arjs = "trackingMethod: best; sourceType: webcam; debugUIEnabled: false; detectionMode: mono; patternRatio: 0.9;"
        id = "scene"
        embedded
    >
        <a-assets>
            <video 
                id = "mantarayanimation"
                playsinline
                preload = "auto"
                loop="true" 
                onplay="videoplaying('mantarayanimation')"
                onpause="videopaused('mantarayanimation')"
            >
                <source src="../files/mantaray-YT.mp4" type="video/mp4">
            </video>    
        </a-assets> 
        
        <a-marker 
            type = "pattern"
            url = "../files/pattern-qr-code-animationqr.patt"
            id = "pattern-qr-code-animationqr"
            emitevents = "true"
            markerhandler
            smoothCount = 0 
            smoothTolerance = 0.0001
        >
            <a-video  
                rotation = "270 0 0"
                position = "0 0 0"
                src = "#mantarayanimation"
                scale = "1.414 1 1"
            >
            </a-video>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>
    
    <div style = "position: fixed;
                  top: 1vh; 
                  left: 1vw; 
                  font-family: Tahoma, sans-serif;
                  font-size: 4vmin;
                  color: #d90202;
                  background-color: #FFFFFF;">
      
      <span id = "fps">
      --
      </span>

    FPS
    </div>
    
    <button
        disabled
        id = "playpausebutton"
        style = "position: fixed; 
                 right: 5px; 
                 bottom: 5px; 
                 padding: 10px 10px; 
                 background-color: #ff0015; 
                 border: none;
                 border-radius: 50%;
                 display: none;"
        type = "button"
        onclick = "playpause()"
    >
        <img 
             src = "../files/play-256.png" 
             style = "width: 90%; height: auto; max-width: 5vmax"
             id = "buttonimg"
             />
    </button>
    <div style = "width: 35vmin; 
                  height: auto; 
                  position: fixed; 
                  left: 10px; 
                  bottom: 0px;">
        <img 
            id = "markerimageref"
            src = "../files/pattern-qr-code-animationqr.png" 
            style = "width: 35vmin; 
                     height: auto;
                     postition: relative;
                     margin-bottom: -4.5vmin"
        >
        </img>
        <p
            id = "sidetext"
            style = "position: relative; 
                     font-family: Tahoma, sans-serif;
                     font-size: 3.855vmin;
                     color: #d90202;
                     text-align: center;"
        >
        <span style = "background-color: #FFFFFF"><b>Find and scan me!<b></span><br> 
        </p>
    </div>
    <button
        disabled
            id = "enterbutton"
            class = "poppin"
            style = "position: fixed; 
                     top: 60vh; 
                     left: 47.5vw; 
                     padding: 10px 10px; 
                     background-color: #e3cc00; 
                     border: none;
                     border-radius: 50%;
                     display: none;"
            type = "button"
            onclick = "transition()"
        >
        <img 
                 src = "../files/white-magnifying-glass.png" 
                 style = "height: 5vmax; width: 5vmax"
                 id = "enterbuttonimg"
                 />
        </button>
  </body>
</html>
